#!/usr/bin/env php
<?php

    require(__DIR__ . "/../includes/config.php");
    
    echo "hello\n"; 
    
    var_dump($argc);
    var_dump($argv);
    
    if ($argc != 2)
    {
        echo "Usage: ./import /path/to/file\n";
    }
    
    else
    {
        if (!is_readable ($argv[1]))
        {
            echo "error: file is not readable\n";
        }
        
        $handle = fopen($argv[1], "r");
        
        if ($handle == false)
        {
            echo "file could not be opened!\n";
            exit(1);
        }
        
        while ($row = fgetcsv($handle, 1000, "\t"))
        {
             $country_code = $row[0];
             $postal_code = $row[1];
             $place_name = $row[2];
             $admin_name1 = $row[3];
             $admin_code1 = $row[4];
             $admin_name2 = $row[5];
             $admin_code2 = $row[6];
             $admin_name3 = $row[7];
             $admin_code3 = $row[8];
             $latitude = $row[9];
             $longitude = $row[10]; 
             $accuracy = $row[11]; 
             
             CS50::query("INSERT INTO `final project`.`places` (country_code, postal_code, place_name, admin_name1, admin_code1, admin_name2, admin_code2,
             admin_name3, admin_code3, latitude, longitude, accuracy) VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)", 
             $country_code, $postal_code, $place_name, $admin_name1, $admin_code1, $admin_name2, $admin_code2,
             $admin_name3, $admin_code3, $latitude, $longitude, $accuracy); 
        } 
        
        var_dump($country_code, $postal_code, $place_name, $admin_name1, $admin_code1, $admin_name2, $admin_code2, $admin_name3, 
        $admin_code3, $latitude, $longitude); 
    
    }
        
    

?>